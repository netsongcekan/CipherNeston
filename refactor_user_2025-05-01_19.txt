Refactor user authentication for response (major)
